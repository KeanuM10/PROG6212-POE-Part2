@{
    Layout = "~/Views/Shared/_Layout.cshtml"; // Use the site wide layout
    ViewData["Title"] = "Claim Submission";  // Set page title
}

<div class="container mt-5">
    <h2>Claim Submission</h2>

    <!-- Display Validation Errors (Summary) -->
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <!-- Form - submit the claim (Updated with hourly rate and notes)-->
    <form method="post" enctype="multipart/form-data" action="@Url.Action("SubmitClaim", "Home")">
        <div class="form-group">
            <label for="hoursWorked">Hours Worked:</label>
            <input type="number" id="hoursWorked" name="hoursWorked" class="form-control" placeholder="Enter hours worked" step="0.01" required />
        </div>

        <!-- Hourly rate set to 0.01 - allows decimals (will be better later on) -->
        <div class="form-group">
            <label for="hourlyRate">Hourly Rate:</label>
            <input type="number" id="hourlyRate" name="hourlyRate" class="form-control" placeholder="Enter hourly rate" step="0.01" required />
        </div>

        <!-- Auto-Calculated Payment -->
        <div class="form-group">
            <label for="totalPayment">Total Payment:</label>
            <input type="text" id="totalPayment" class="form-control" readonly />
        </div>

        <div class="form-group">
            <label for="notes">Additional Notes:</label>
            <textarea id="notes" name="notes" class="form-control" placeholder="Add any additional notes here" rows="4"></textarea>
        </div>
        <!-- Supporting Document Upload -->
        <div class="form-group">
            <label for="document">Supporting Document (PDF, DOCX, XLSX - Max 5MB):</label>
            <input type="file" id="document" name="document" class="form-control-file" accept=".pdf,.docx,.xlsx" />
            <span class="text-danger">@ViewData.ModelState["document"]?.Errors.FirstOrDefault()?.ErrorMessage</span>
        </div>


        <!-- Submit button -->
        <div>
            <button type="submit" class="btn btn-success" style="width: 200px; height: 40px;">Submit Claim</button>
        </div>
    </form>
    <!-- Link - view claim status -->
    <div>
        <a href="@Url.Action("ClaimStatus", "Home")" class="btn btn-secondary mt-3" style="width: 200px; height: 40px;">Go to Claim Status</a>
    </div>
</div>

<script>
    // Auto-calculation logic
    document.addEventListener("DOMContentLoaded", function () {
        const hoursWorkedInput = document.getElementById("hoursWorked");
        const hourlyRateInput = document.getElementById("hourlyRate");
        const totalPaymentInput = document.getElementById("totalPayment");

        function calculateTotalPayment() {
            const hoursWorked = parseFloat(hoursWorkedInput.value) || 0;
            const hourlyRate = parseFloat(hourlyRateInput.value) || 0;
            const totalPayment = hoursWorked * hourlyRate;
            totalPaymentInput.value = totalPayment.toFixed(2); // Format to 2 decimal places
        }

        // Add event listeners to recalculate on input change
        hoursWorkedInput.addEventListener("input", calculateTotalPayment);
        hourlyRateInput.addEventListener("input", calculateTotalPayment);
    });
</script>
